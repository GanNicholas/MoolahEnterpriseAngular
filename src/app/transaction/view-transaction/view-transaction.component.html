<app-header></app-header>
<br />
<div id="divForTabs ">
<p-tabView >
    <p-tabPanel header="View Transaction History For Product Listing">
        <br/>
        <div id="filterDate">
            From : <input pInputText name="startDate" type="date" [(ngModel)]="startDateProductListing" [disabled]="false">
            To :
            <input pInputText name="endDate" type="date" [(ngModel)]="endDateProductListing" [disabled]="false"> &nbsp;
            <p-button type="button" (click)="searchForTransactionProductListing()">Search</p-button>
        </div>
        <br/>
        <div id="viewTransactionForBill">

            <p-table id="tablePointOfContact" [value]="listOfAllSpecificHistoricalTransaction">
                <ng-template pTemplate="header">
                    <tr>
                        <th class="p-datatable-thead" style="width: 7%; text-align: center">
                            S/N
                        </th>
                        <th style="text-align: center">Monthly Payment ID:</th>

                        <th style="text-align: center">
                            Date Transacted
                        </th>
                        <th style="width: 7%; text-align: center">Payment Number</th>

                        <th style="text-align: center">Date Generated</th>
                        <th style="text-align: center">Total Payable</th>
                        <th style="text-align: center">View details of product</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-rowIndex="rowIndex" let-pw>
                    <tr>
                        <td style="text-align: center">{{ rowIndex + 1 }}</td>
                        <td>
                            {{pw.paymentEntity.paymentId}}
                        </td>

                        <td>
                            {{pw.paymentEntity.dateTransacted}}
                        </td>

                        <td>
                            {{pw.paymentEntity.paymentNumber}}
                        </td>


                        <td>
                            {{pw.paymentEntity.dateGenerated}}

                        </td>
                        <td>

                            {{pw.totalPayable}}

                        </td>

                        <td>
                            <p-button label="View" (click)="viewLineItems($event, rowIndex)" ></p-button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
        <p-dialog  (visibleChange)="clearDialog($event)"  [(visible)]="displayPopUp"
            [modal]="true">
            <div class="card" *ngIf="listOfProductLineItem.length > 0">
                <h3>View Product Line Item(s) for Payment S/N(Payment Id) : {{selectedLineItem+1}} ({{listOfAllSpecificHistoricalTransaction[selectedLineItem].paymentEntity.paymentId}})</h3>
                
                <p-table [value]="listOfProductLineItem">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Product Line Item ID</th>
                            <th>Product ID</th>
                            <th>Monthly Clicks</th>
                            <th>Monthly subtotal credit</th>
                            <th>Fixed Subscription credit</th>

                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-pl let-rowIndex="index">
                        <tr>
                            <td>{{ pl.prodcutLineItemId }}</td>
                            <td>{{ pl.product.productId }}</td>
                            <td>{{ pl.monthlyClicks }}</td>
                            <td>{{ pl.monthlySubtotalCredit }}</td>
                            <td>{{ pl.fixedSubscriptionCredit}}</td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </p-dialog>
    </p-tabPanel>
    <p-tabPanel header="View Transaction History For Credit Purchased">
        <br/>
        <div id="filterDate">
            From : <input pInputText name="startDate" type="date" [(ngModel)]="startDateCreditPayment" [disabled]="false">
            To :
            <input pInputText name="endDate" type="date" [(ngModel)]="endDateCreditPayment" [disabled]="false"> &nbsp;
            <p-button type="button" (click)="searchForTransactionCreditPayment()">Search</p-button>
        </div>
        <br/>
        <div id="viewTransactionCredit">

            <p-table id="tablePointOfContact" [value]="listOfAllSpecificCreditHistoricalTransaction">
                <ng-template pTemplate="header">
                    <tr>
                        <th class="p-datatable-thead" style="width: 7%; text-align: center">
                            S/N
                        </th>
                        <th style="text-align: center">Payment ID:</th>

                        <th style="text-align: center">
                            Date Transacted
                        </th>
                        <th style="width: 7%; text-align: center">Payment Number</th>

                        <th style="text-align: center">Credit Purchased</th>
                        <th style="text-align: center">Total Payable</th>
                   </tr>
                </ng-template>

                <ng-template pTemplate="body" let-rowIndex="rowIndex" let-pc>
                    <tr>
                        <td style="text-align: center">{{ rowIndex + 1 }}</td>
                        <td>
                            {{pc.paymentEntity.paymentId}}
                        </td>

                        <td>
                            {{pc.paymentEntity.dateTransacted}}
                        </td>

                        <td>
                            {{pc.paymentEntity.paymentNumber}}
                        </td>


                        <td>
                            {{pc.creditPaymentEntity.creditPurchased}}

                        </td>
                        <td>

                            {{pc.creditPaymentEntity.totalPayable}}

                        </td>

                    </tr>
                </ng-template>
            </p-table>
        </div>

        
    </p-tabPanel>
</p-tabView>
</div>
<app-footer></app-footer>